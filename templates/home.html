<!DOCTYPE html>
<html lang="en">

<head>
    {% block head %}
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="Hackbright Project">
    <meta name="author" content="Lora Rose">
    <title>Hackbright Project</title>
    <!-- Bootstrap Core CSS -->
    <link href="static/css/bootstrap.min.css" rel="stylesheet">
    <!-- Custom CSS -->
    <link rel="stylesheet" href="static/css/index-page.css"> 
	<!-- Access to D3 paths -->
	<script src="https://d3js.org/d3.v3.js"></script>
    
    <!-- CSS Style -->
    <style type="text/css">
    /* On mouse hover, lighten state color */   
    path:hover {
        fill-opacity: .7;
    }
    /* Style for Custom Tooltip */
    div.tooltip {
        position: absolute;
        text-align: center;
        width: 60px;
        height: 28px;
        padding: 2px;
        font: 12px sans-serif;
        background: white;
        border: 0px;
        border-radius: 8px;
        pointer-events: none;
        opacity: 0;
        transition: opacity 1s;
    }
    /* Legend Position Style */
    .legend {
        position: left;
        left: 100px;
        top: 150px;
    }
    .rep-image {
        height: 275px;
    }
    </style>

    {% endblock head %}
</head>

<body>
    {% block body %}

<!-- ################## Navigation Bar #################### -->

    <nav class="navbar navbar-inverse navbar-fixed-top" role="navigation">
        <div class="container">
            <!-- Brand and toggle grouped for mobile -->
            <div class="navbar-header">
                <button type="button" class="navbar-toggle" data-toggle="collapse" data-target="#myNavbar">
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                    <span class="icon-bar"></span>
                </button>
            </div>
            <!-- Collect the nav links, forms, etc for toggling -->
            <div class="collapse navbar-collapse" id="myNavbar">
                <ul class="nav navbar-nav">
                    <li class="active"><a href="/">Home</a></li>
                    <li><a href="#representatives">Representatives</a></li>
                    <li><a href="#popwords">Popular Words</a></li>
                    <li><a href="#statewords">Words Per State</a></li>
                </ul>
                <ul class="nav navbar-nav navbar-right">
                    <li><a href="#contact"><span class="glyphicon glyphicon-user"></span> Contact</a></li>
                </ul>
            <!-- /.navbar-collapse -->
            </div>
        <!-- /.container -->
        </div>
    </nav>

<!-- ################## Img Header #################### -->

    <header class="header-image">
        <div class="headline">
            <div class="container">
                <h1>Choose A State</h1>
                <h2>Find Your Representatives</h2>
            </div>
        </div>
    </header>

    <!-- Map -->
    {% block map %}
    <div class="container" id="d3-map">
    	<div class="row"></div>
    </div>
    <script type="text/javascript">
        // Width and height of map
        var w = 1000;
        var h = 700;

        // D3 Projection
        var projection = d3.geo.albersUsa()
            // Translate to center of screen
            .translate([w / 2, h / 2])
            // Scale things down so see entire US
            .scale([1400]);

        // Defines path generator to convert GeoJSON to SVG
        var path = d3.geo.path()
            // tell path generator to use albersUsa projection
            .projection(projection);

        // Define linear scale for output
        var color = d3.scale.linear()
            .range(["rgb(223,209,206)", "rgb(223,209,206)", "rgb(223,209,206)", "rgb(223,209,206)"]);

        var legendText = ["Nada", "Republican", "Democratic", "Frequency"];

        //Creates SVG element and append map to the SVG
        var svg = d3.select("#d3-map")
            .append("svg")
            .attr("width", w)
            .attr("height", h);

        // Append Div for tooltip to SVG
        var div = d3.select("#d3-map")
            .append("div")
            .attr("class", "tooltip")
            .style("opacity", 0);
        
// ############### Popular US Words ####################

        // Load states data
        d3.csv("/state", function(data) {
            color.domain([0, 1, 2, 3]); // setting the range of the input data
            // var capitolwords = []
            // // make empty list
            // for (var i = resp.length - 1; i >= 0; i--) {
            //  var capitolwords = capitolwords.append(resp[i]);
            //  capitolwords.sort()
            //  return capitolwords;
            // };

            // // for loop through data
            // // add the count to the list, for each state/count dict.
            // // sort.

            // replace [0,1,2,3] with your list.
            // color.domain([0, 1, 2, 3]); // setting the range of the input data

            // Load GeoJSON data and merge with states data
            d3.json("/statejson", function(json) {

                // Loop through each state data value in the .csv file
                for (var i = 0; i < data.length; i++) {

                    // Grab State Name
                    var dataState = data[i].state;

                    // Grab data value 
                    var dataValue = data[i].visited;

                    // Find the corresponding state inside the GeoJSON
                    for (var j = 0; j < json.features.length; j++) {

                        var jsonState = json.features[j].properties.name;

                        if (dataState == jsonState) {

                            // Copy the data value into the JSON
                            json.features[j].properties.visited = dataValue;

                            // Stop looking through the JSON
                            break;
                        }
                    }
                }

                // Bind the data to the SVG and create one path per GeoJSON feature
                svg.selectAll("path")
                    .data(json.features)
                    .enter()
                    .append("path")
                    .attr("d", path)
                    .style("stroke", "#fff")
                    .style("stroke-width", "1")
                    .style("fill", function(d) {

                        // Get data value
                        var value = d.properties.visited;

                        if (value) {
                            //If value exists…
                            return color(value);
                        } else {
                            //If value is undefined…
                            return "rgb(123,123,123)";
                        }
                    })

                .on("mouseover", function(d) {
                    div.transition()
                        .duration(200)
                        .style("opacity", .9);
                    div.text(d.state)
                        .style("left", (d3.event.pageX) + "px")
                        .style("top", (d3.event.pageY - 28) + "px");
                })

                // fade out tooltip on mouse out               
                .on("mouseout", function(d) {
                    div.transition()
                        .duration(500)
                        .style("opacity", 0);
                });

// ################## Bubbles ####################

                // Map the states where word is used!
                // d3.csv("/city", function(data) {
                //     // debugger;
                //     svg.selectAll("circle")
                //         .data(data)
                //         .enter()
                //         .append("circle")
                //         .attr("cx", function(d) {
                //             return projection([d.lon, d.lat])[0];
                //         })
                //         .attr("cy", function(d) {
                //             return projection([d.lon, d.lat])[1];
                //         })
                //         .attr("r", function(d) {
                //             return Math.sqrt(d.years) * 4;
                //         })
                //         .style("fill", "rgb(223,223,223)")
                //         .style("opacity", 0.7)

                //     // add browser tooltip of city name
                //     .append("title")
                //         .text(function(d) {
                //             return d.place;
                //         });

// ################## Legend ####################

                    // // Modified Legend Code from Mike Bostock: http://bl.ocks.org/mbostock/3888852
                    // var legend = d3.select("body").append("svg")
                    //     .attr("class", "legend")
                    //     .attr("width", 140)
                    //     .attr("height", 200)
                    //     .selectAll("g")
                    //     .data(color.domain().slice().reverse())
                    //     .enter()
                    //     .append("g")
                    //     .attr("transform", function(d, i) {
                    //         return "translate(0," + i * 20 + ")";
                    //     });

                    // legend.append("rect")
                    //     .attr("width", 18)
                    //     .attr("height", 18)
                    //     .style("fill", color);

                    // legend.append("text")
                    //     .data(legendText)
                    //     .attr("x", 24)
                    //     .attr("y", 9)
                    //     .attr("dy", ".35em")
                    //     .text(function(d) {
                    //         return d;
                    //     });
                // });

            });

        });
        //   // This code generate paths without mapping to other data
        // // Load JSON file and generate path for each state
        // d3.json("us-states.json", function(json) {  // file path, callback function called when data loaded
        //      svg.selectAll("path")               // creates empty references to all the paths
        //         .data(json.features)             // loop through our data (the states in the array) and bind to paths
        //         .enter()                         // create placeholder to reference the new elements
        //         .append("path")                  // add to the DOM!
        //         .attr("d", path)                 // generate paths for each state
        //         .style("fill", "steelblue");     // make the states blue!
        //      });
        </script>

    {% endblock map %}

    <!-- Page Content -->
	
<!-- ################## Find Reps #################### -->

	<hr class="featurette-divider" id="representatives">
        <div class="featurette" id="repdetails">
        	<p class="lead">
            <div class="container">
            	<div class="row">
            	<div class="col-sm-7">
            	<h2 class="featurette-heading">Find Your Representatives
                <br><span class="text-muted">By Location</span></h2>
                <p>Lorem ipsum dolor sit amet, consectetur adipisicing elit. Et molestiae similique eligendi reiciendis sunt distinctio odit? Quia, neque, ipsa, adipisci quisquam ullam deserunt accusantium illo iste exercitationem nemo voluptates asperiores.Lorem ipsum dolor sit amet, consectetur adipisicing elit. Et molestiae similique eligendi reiciendis sunt distinctio odit? Quia, neque, ipsa, adipisci quisquam ullam deserunt accusantium illo iste exercitationem nemo voluptates asperiores.</p>
            </div>
			<div class="col-sm-1"></div>
            <div class="col-sm-4">
				
				<form action="/repdetails" method="POST" role="form" class="form-horizontal">
  					<div class="form-group">
  						<label for="city" class="col-sm-2 control-label">City:</label><br>
                        <!-- Accept city from user  -->
                        <input type="text" class="form-control" name="city" id="city" required>
                    </div><p></p>
					
					<div class="form-group">
  						<label for="state" class="col-sm-2 control-label">State:</label><br>
  						<select name="state" id="state" class="form-control">
                        <!-- Drop down menu for choosing state 
            	and display a certain length -->
					    <option value="AL">Alabama</option>
						<option value="AK">Alaska</option>
						<option value="AZ">Arizona</option>
						<option value="AR">Arkansas</option>
						<option value="CA">California</option>
						<option value="CO">Colorado</option>
						<option value="CT">Connecticut</option>
						<option value="DE">Delaware</option>
						<option value="DC">District Of Columbia</option>
						<option value="FL">Florida</option>
						<option value="GA">Georgia</option>
						<option value="HI">Hawaii</option>
						<option value="ID">Idaho</option>
						<option value="IL">Illinois</option>
						<option value="IN">Indiana</option>
						<option value="IA">Iowa</option>
						<option value="KS">Kansas</option>
						<option value="KY">Kentucky</option>
						<option value="LA">Louisiana</option>
						<option value="ME">Maine</option>
						<option value="MD">Maryland</option>
						<option value="MA">Massachusetts</option>
						<option value="MI">Michigan</option>
						<option value="MN">Minnesota</option>
						<option value="MS">Mississippi</option>
						<option value="MO">Missouri</option>
						<option value="MT">Montana</option>
						<option value="NE">Nebraska</option>
						<option value="NV">Nevada</option>
						<option value="NH">New Hampshire</option>
						<option value="NJ">New Jersey</option>
						<option value="NM">New Mexico</option>
						<option value="NY">New York</option>
						<option value="NC">North Carolina</option>
						<option value="ND">North Dakota</option>
						<option value="OH">Ohio</option>
						<option value="OK">Oklahoma</option>
						<option value="OR">Oregon</option>
						<option value="PA">Pennsylvania</option>
						<option value="RI">Rhode Island</option>
						<option value="SC">South Carolina</option>
						<option value="SD">South Dakota</option>
						<option value="TN">Tennessee</option>
						<option value="TX">Texas</option>
						<option value="UT">Utah</option>
						<option value="VT">Vermont</option>
						<option value="VA">Virginia</option>
						<option value="WA">Washington</option>
						<option value="WV">West Virginia</option>
						<option value="WI">Wisconsin</option>
						<option value="WY">Wyoming</option>
                        </select>
                    </div><p></p>
                    <!-- Submit user input to server.py for submission to Sunlight API  -->
					<div class="form-group">
    					<div class="col-sm-offset-1 col-sm-10">
      					<button type="submit" class="btn btn-default">Search</button>
					    </div>
					</div>
				</form>
            </p></div>
		</div>
    </div>

<!-- ################## Rep Details #################### -->

    {% if city %}
    <hr class="featurette-divider">
    <p class="lead">
    <div class="container">
	<h1 class="featurette-heading">Representative
        <span class="text-muted">Details for</span>
        {{ city }} and {{ state }}</h1>
		<p></p>

    <!-- Sunlight Congress API data  -->
		<div class="row">
		{% for key in leg_details_congress %}
        <div class="col-sm-4">
			<!-- USERPIC -->
			<div class="profile-userpic">
			<figure id="rep-image">
                <img class="img-circle img-responsive" alt="" src="https://theunitedstates.io/images/congress/225x275/{{ key['bioguide_id'] }}.jpg">
            </figure>
			</div><p></p>

			<!-- USER TITLE -->
			<div class="profile-usertitle">
				<div class="profile-usertitle-name">
					{{ key['first_name'] }} {{ key['last_name'] }}
				</div><p></p>
				<div class="profile-usertitle-details">
					{{ key['chamber'].capitalize() }} | District: {{ key['district'] }}
				</div>
			</div>
			
			<!-- LABELS -->
			<div class="profile-userlabels">
				<h3><span class="label label-default">
					{% if key['party'] == 'D' %}
						Democrat
					{% elif key == 'R' %}
						Republican
					{% else %}
						Independent
					{% endif %}
				</span>
			</div>
			
			<!-- MENU -->
			<div class="profile-usermenu">
				<ul class="nav">
					<li class="active">
						<a href="{{ key['website'] }}">
						<i class="glyphicon glyphicon-home"></i>
						Website </a>
					</li>
					<li>
						<a href="tel://1-{{ key['phone'] }}">
						<i class="glyphicon glyphicon-user"></i>
						Office Phone </a>
					</li>
					<li>
						<a href="#" target="_blank">
						<i class="glyphicon glyphicon-ok"></i>
						Tasks </a>
					</li>
				</ul>
                <p></p>
            <div class="rep-tweets">
                <a class="twitter-timeline" data-height="1000" href="https://twitter.com/{{ key['twitter_id'] }}">Tweets by {{ key['first_name'] }} {{ key['last_name'] }}</a>
                <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
			</div>
			<div class="col-sm-1"></div>
		</div>
		{% endfor %}
		</div>
		<p></p>

    <!-- Sunlight Open States API data  -->
		<div class="row">
		{% for key in leg_details_openstates %}
        <div class="col-sm-4">
			<!-- USERPIC -->
			<div class="profile-userpic">
			<figure>
                <img class="img-circle img-responsive" id="rep-image" width="225" height="275" src="{{ key['photo_url'] }}">
            </figure>
			</div><p></p>

			<!-- USER TITLE -->
			<div class="profile-usertitle">
				<div class="profile-usertitle-name">
					{{ key['full_name'] }}
				</div><p></p>
				<div class="profile-usertitle-details">
					{{ key['chamber'].capitalize() }} | District: {{ key['district'] }}
				</div>
			</div>
			
			<!-- LABELS -->
			<div class="profile-userlabels">
				<h3><span class="label label-default">
					{% if key['party'] == 'D' %}
						Democrat
					{% elif key == 'R' %}
						Republican
					{% else %}
						Independent
					{% endif %}
				</span>
			</div>

			<!-- MENU -->
			<div class="profile-usermenu">
				<ul class="nav">
					<li class="active">
						<a href="">
						<i class="glyphicon glyphicon-home"></i>
						Website </a>
					</li>
					<li>
						<a href="">
						<i class="glyphicon glyphicon-user"></i>
						Office Phone </a>
					</li>
					<li>
						<a href="" target="_blank">
						<i class="glyphicon glyphicon-ok"></i>
						Tasks </a>
					</li>
				</ul>
			</div>
			<div class="col-sm-1"></div>
		</div>
		{% endfor %}
		</div>
	</p>
	</div>
	{% endif %}

<!-- // ################## Pop State Words #################### -->

    <hr class="featurette-divider" id="statewords">
    <div class="featurette">
        	<p class="lead">
            <div class="container">
            	<div class="row">
            	<div class="col-sm-5">
            	<img class="featurette-image img-circle img-responsive pull-left" src="http://placehold.it/500x500">
            	</div>
				<div class="col-sm-1"></div>
				<div class="col-sm-5">
            	<h2 class="featurette-heading">Most Popular Words
                <span class="text-muted">Used by State Legislators</span></h2>

			<!-- Access Sunlight API via server  -->
			<form action="/topwords_per_state" method="POST" role="form" class="form-horizontal">
					<div class="form-group">
  						<label for="state" class="col-sm-2 control-label">State:</label><br>
  						<select name="state" id="state" class="form-control">
                        <!-- Drop down menu for choosing state 
            	and display a certain length -->
					    <option value="AL">Alabama</option>
						<option value="AK">Alaska</option>
						<option value="AZ">Arizona</option>
						<option value="AR">Arkansas</option>
						<option value="CA">California</option>
						<option value="CO">Colorado</option>
						<option value="CT">Connecticut</option>
						<option value="DE">Delaware</option>
						<option value="DC">District Of Columbia</option>
						<option value="FL">Florida</option>
						<option value="GA">Georgia</option>
						<option value="HI">Hawaii</option>
						<option value="ID">Idaho</option>
						<option value="IL">Illinois</option>
						<option value="IN">Indiana</option>
						<option value="IA">Iowa</option>
						<option value="KS">Kansas</option>
						<option value="KY">Kentucky</option>
						<option value="LA">Louisiana</option>
						<option value="ME">Maine</option>
						<option value="MD">Maryland</option>
						<option value="MA">Massachusetts</option>
						<option value="MI">Michigan</option>
						<option value="MN">Minnesota</option>
						<option value="MS">Mississippi</option>
						<option value="MO">Missouri</option>
						<option value="MT">Montana</option>
						<option value="NE">Nebraska</option>
						<option value="NV">Nevada</option>
						<option value="NH">New Hampshire</option>
						<option value="NJ">New Jersey</option>
						<option value="NM">New Mexico</option>
						<option value="NY">New York</option>
						<option value="NC">North Carolina</option>
						<option value="ND">North Dakota</option>
						<option value="OH">Ohio</option>
						<option value="OK">Oklahoma</option>
						<option value="OR">Oregon</option>
						<option value="PA">Pennsylvania</option>
						<option value="RI">Rhode Island</option>
						<option value="SC">South Carolina</option>
						<option value="SD">South Dakota</option>
						<option value="TN">Tennessee</option>
						<option value="TX">Texas</option>
						<option value="UT">Utah</option>
						<option value="VT">Vermont</option>
						<option value="VA">Virginia</option>
						<option value="WA">Washington</option>
						<option value="WV">West Virginia</option>
						<option value="WI">Wisconsin</option>
						<option value="WY">Wyoming</option>
                        </select>
                    </div><p></p>
                    <!-- Submit user input to server.py for submission to Sunlight API  -->
					<div class="form-group">
    					<div class="col-sm-offset-1 col-sm-10">
      					<button type="submit" class="btn btn-default">Search</button>
					    </div>
					</div>
				</form>
				<div class="col-sm-1"></div>
            </div>          
		</div>
    </div>

    <hr class="featurette-divider">

<!-- ################## Pop State Words Details #################### -->

    {% if state %}
    <hr class="featurette-divider">
    <p class="lead">
    <div class="container">
    <h1 class="featurette-heading">Representative
        <span class="text-muted">Details for</span>
        {{ city }} and {{ state }}</h1>
        <p></p>

    <!-- Sunlight Congress API data  -->
        <div class="row">
        {% for key in leg_details_congress %}

<!-- // ################## Pop Words #################### -->

    <hr class="featurette-divider" id="popwords">
    <div class="featurette">
        <p class="lead">
        <div class="container">
            <div class="row">
                <div class="col-sm-5">
                    <h2 class="featurette-heading">Most Popular Words
                    <span class="text-muted">Used by Congress</span></h2>
                </div>
                <div class="col-sm-1"></div>
                <div class="col-sm-5">
                    <img class="featurette-image img-circle img-responsive pull-right" src="http://placehold.it/500x500">
                </div>

            <!-- Access Sunlight API via server  -->
                <form action="/topwords_per_state" method="POST" role="form" class="form-horizontal">
                <div class="form-group">
                    <label for="word" class="col-sm-2 control-label">Word:</label><br>
                    <!-- Accept word from user  -->
                    <input type="text" class="form-control" name="word" id="word" required>
                </div>
            </div>
        </div>
        </p>
    </div>

<!-- ################## Footer #################### -->

    <footer>
        <hr class="featurette-divider" id="footer">
        <div class="row">
            <div class="col-lg-12">
                <p>
                    <center>Copyright by <a href="http://www.aroseartist.com/">Lora Rose</a> ©2016</center>
                </p>
            </div>
        </div>
    </footer>

    <!-- /.container -->
    </div>
    <!-- jQuery -->
    <script src="js/jquery.js"></script>
    <!-- Bootstrap Core JavaScript -->
    <script src="js/bootstrap.min.js"></script>

    {% endblock %}
</body>
</html>